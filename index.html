<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Mario Phaser</title>
    <link rel="icon" type="image/x-icon" href="assets/favicon.png">
    <link rel="preload" href="assets/others/loading.gif" />
    <link rel="stylesheet" href="assets/css/style.css" />
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <style>
      /* On-screen touch controls */
      #controls-left, #controls-right {
        position: fixed;
        bottom: 20px;
        display: flex;
        gap: 10px;
        z-index: 999;
      }
      #controls-left { left: 20px; }
      #controls-right { right: 20px; }
      button {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        font-size: 24px;
        opacity: 0.6;
        background: #00000050;
        color: white;
        border: none;
      }
    </style>
  </head>
  <body>
    <div id="game">
      <img id="gif" src="assets/others/loading.gif" alt="Loading animation" class="loading-gif">
      <img id="gif-shadow" src="assets/others/loading.gif" alt="Loading animation shadow" class="loading-gif">
    </div>

    <!-- Touch Controls -->
    <div id="controls-left">
      <button id="left-btn">‚óÄÔ∏è</button>
      <button id="right-btn">‚ñ∂Ô∏è</button>
    </div>
    <div id="controls-right">
      <button id="jump-btn">‚¨ÜÔ∏è</button>
      <button id="shoot-btn">üî•</button>
    </div>

    <noscript>
      <div class="blurbg">
        <div class="alertpopup">
          <h2>JavaScript disabled!</h2>
          <hr>
          <p>This website uses JavaScript to work, otherwise the game will not load.</p>
          <p>Enable or stop blocking JavaScript and try again.</p>
        </div>
      </div>
    </noscript>

    <!-- Existing Game Scripts -->
    <script src="./javascript/game.js" type="text/javascript"></script>
    <script src="./javascript/game/animations.js" type="text/javascript"></script>
    <script src="./javascript/game/blocks.js" type="text/javascript"></script>
    <script src="./javascript/game/strucutres.js" type="text/javascript"></script>
    <script src="./javascript/game/settings.js" type="text/javascript"></script>
    <script src="./javascript/game/fireball.js" type="text/javascript"></script>
    <script src="./javascript/game/player-control.js" type="text/javascript"></script>
    <script src="./javascript/game/hud-control.js" type="text/javascript"></script>
    <script src="./javascript/game/entities-control.js" type="text/javascript"></script>
    <script src="./javascript/helpers/screenshot.js" type="text/javascript"></script>
    <script src="./javascript/helpers/window-title.js" type="text/javascript"></script>

    <!-- Touch Control Logic -->
    <script>
      // Make sure 'player' and 'fireballShoot' exist in your game
      const leftBtn = document.getElementById('left-btn');
      const rightBtn = document.getElementById('right-btn');
      const jumpBtn = document.getElementById('jump-btn');
      const shootBtn = document.getElementById('shoot-btn');

      // Left movement
      leftBtn.addEventListener('touchstart', () => { if(player) player.setVelocityX(-160); });
      leftBtn.addEventListener('touchend', () => { if(player) player.setVelocityX(0); });

      // Right movement
      rightBtn.addEventListener('touchstart', () => { if(player) player.setVelocityX(160); });
      rightBtn.addEventListener('touchend', () => { if(player) player.setVelocityX(0); });

      // Jump
      jumpBtn.addEventListener('touchstart', () => { 
        if(player && player.body.touching.down) player.setVelocityY(-330);
      });

      // Shoot
      shootBtn.addEventListener('touchstart', () => { 
        if(typeof fireballShoot === 'function') fireballShoot();
      });
    </script>
  </body>
</html>
